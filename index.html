<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sập Bẫy Online - Một Khoảnh Khắc Cảnh Tỉnh</title>
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://aivengersaicomic.vercel.app/">
    <meta property="og:title" content="Sập Bẫy Online - Một Khoảnh Khắc Cảnh Tỉnh">
    <meta property="og:description" content="Truyện tranh giáo dục về nguy cơ lừa đảo trực tuyến dành cho học sinh 11-18 tuổi. Câu chuyện về Mai và bài học đắt giá khi mua sắm online.">
    <meta property="og:image" content="https://aivengersaicomic.vercel.app/images/page6.png">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://aivengersaicomic.vercel.app/">
    <meta property="twitter:title" content="Sập Bẫy Online - Một Khoảnh Khắc Cảnh Tỉnh">
    <meta property="twitter:description" content="Truyện tranh giáo dục về nguy cơ lừa đảo trực tuyến dành cho học sinh 11-18 tuổi. Câu chuyện về Mai và bài học đắt giá khi mua sắm online.">
    <meta property="twitter:image" content="https://aivengersaicomic.vercel.app/images/page6.png">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Roboto', 'San Francisco', -apple-system, system-ui, sans-serif;
            background: #f7f8fa;
            color: #222;
            overflow-x: hidden;
        }

        /* Header Section */
        .header {
            background: linear-gradient(135deg, #fceabb 0%, #f8b500 100%);
            padding: 60px 40px;
            text-align: center;
            border-bottom: 2px solid #ffb347;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 120"><path d="M0,0 Q300,60 600,30 T1200,60 L1200,120 L0,120 Z" fill="rgba(255,179,71,0.1)"/></svg>') no-repeat bottom;
            background-size: cover;
            opacity: 0.2;
        }

        .comic-logo {
            position: relative;
            z-index: 1;
        }

        .comic-title {
            font-size: 3.5em;
            font-weight: 900;
            background: linear-gradient(135deg, #d97706, #ea580c);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 15px;
            text-shadow: 0 0 20px rgba(217, 119, 6, 0.3);
            letter-spacing: 2px;
        }

        .comic-subtitle {
            font-size: 1.5em;
            color: #d97706;
            margin-bottom: 20px;
            font-weight: 600;
            letter-spacing: 1px;
        }

        .comic-meta {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
            margin-top: 25px;
            position: relative;
            z-index: 1;
        }

        .meta-item {
            background: rgba(255, 255, 255, 0.9);
            color: #1f2937;
            padding: 10px 20px;
            border-radius: 20px;
            border: 1px solid #d97706;
            font-size: 0.95em;
            backdrop-filter: blur(2px);
        }

        .meta-label {
            color: #d97706;
            font-weight: 700;
            margin-right: 8px;
        }

        /* Story Section */
        .story-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 60px 40px;
            background: linear-gradient(180deg, #fffbe6 0%, #f7f8fa 100%);
        }

        .story-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 30px;
        }

        .story-icon {
            font-size: 2.5em;
            filter: drop-shadow(0 0 10px rgba(255, 179, 71, 0.3));
        }

        .story-title {
            font-size: 2em;
            color: #d97706;
            font-weight: 700;
        }

        .story-content {
            font-size: 1.15em;
            line-height: 1.9;
            color: #1f2937;
            background: rgba(255, 255, 255, 0.9);
            padding: 30px;
            border-radius: 15px;
            border-left: 4px solid #d97706;
            box-shadow: 0 4px 20px rgba(217, 119, 6, 0.08);
        }

        /* Character Section */
        .character-section {
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 40px 60px;
        }

        .character-card {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border-radius: 20px;
            padding: 35px;
            border: 1px solid #d97706;
            box-shadow: 0 4px 20px rgba(217, 119, 6, 0.08);
        }

        .character-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid #d97706;
        }

        .character-name {
            font-size: 2em;
            color: #d97706;
            font-weight: 700;
        }

        .character-role {
            background: rgba(217, 119, 6, 0.15);
            padding: 8px 20px;
            border-radius: 20px;
            color: #92400e;
            font-size: 0.9em;
            font-weight: 700;
        }

        .character-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .detail-group {
            background: rgba(255, 255, 255, 0.8);
            padding: 15px;
            border-radius: 10px;
        }

        .detail-label {
            color: #d97706;
            font-weight: 700;
            font-size: 0.85em;
            text-transform: uppercase;
            margin-bottom: 8px;
            letter-spacing: 1px;
        }

        .detail-value {
            color: #1f2937;
            font-size: 1em;
            line-height: 1.6;
        }

        /* Start Reading Button */
        .start-reading-section {
            text-align: center;
            padding: 40px;
            background: linear-gradient(180deg, #fffbe6 0%, #ffe0b2 100%);
        }

        .start-reading-btn {
            padding: 20px 50px;
            font-size: 1.3em;
            font-weight: 700;
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: #ffffff;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 10px 40px rgba(217, 119, 6, 0.3);
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .start-reading-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 50px rgba(217, 119, 6, 0.4);
        }

        /* Comic Viewer */
        .comic-viewer-wrapper {
            background: #fffbe6;
            min-height: 100vh;
            padding: 40px 20px;
            display: none;
        }

        .comic-viewer-wrapper.active {
            display: block;
        }

        .reading-controls {
            max-width: 1400px;
            margin: 0 auto 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 30px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            backdrop-filter: blur(2px);
            border: 1px solid #d97706;
            flex-wrap: wrap;
            gap: 20px;
        }

        .page-indicator {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .page-number {
            font-size: 1.3em;
            font-weight: 700;
            color: #d97706;
        }

        .page-title {
            font-size: 1.1em;
            color: #1f2937;
        }

        .controls-right {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .fullscreen-btn, .close-btn, .bw-filter-btn {
            padding: 12px 25px;
            background: rgba(255, 255, 255, 0.9);
            border: 2px solid #d97706;
            color: #d97706;
            border-radius: 10px;
            font-size: 0.95em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .fullscreen-btn:hover, .close-btn:hover, .bw-filter-btn:hover {
            background: #fde68a;
            transform: translateY(-3px);
        }

        .bw-filter-btn.active {
            background: #d97706;
            border-color: #92400e;
            color: #fff;
        }

        .animation-toggle-btn.active {
            background: #d97706;
            border-color: #92400e;
            color: #fff;
        }

        .comic-display {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 70vh;
            position: relative;
            overflow: hidden;
        }

        .page-container {
            width: 100%;
            display: none;
            position: absolute;
        }

        .page-container.active {
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        /* Smooth Slide & Fade Page Turn Animations - Best Practice */
        .page-container.slide-next-enter {
            animation: slideNextEnter 0.8s cubic-bezier(0.4, 0.0, 0.2, 1) forwards;
        }

        .page-container.slide-next-exit {
            animation: slideNextExit 0.8s cubic-bezier(0.4, 0.0, 0.2, 1) forwards;
        }

        .page-container.slide-prev-enter {
            animation: slidePrevEnter 0.8s cubic-bezier(0.4, 0.0, 0.2, 1) forwards;
        }

        .page-container.slide-prev-exit {
            animation: slidePrevExit 0.8s cubic-bezier(0.4, 0.0, 0.2, 1) forwards;
        }

        /* Slide to next page (current page slides left and fades) */
        @keyframes slideNextExit {
            0% {
                transform: translateX(0) scale(1);
                opacity: 1;
                z-index: 10;
            }
            100% {
                transform: translateX(-100%) scale(0.95);
                opacity: 0;
                z-index: 1;
            }
        }

        /* Slide to next page (new page enters from right) */
        @keyframes slideNextEnter {
            0% {
                transform: translateX(100%) scale(0.95);
                opacity: 0;
                z-index: 5;
            }
            100% {
                transform: translateX(0) scale(1);
                opacity: 1;
                z-index: 10;
            }
        }

        /* Slide to previous page (current page slides right and fades) */
        @keyframes slidePrevExit {
            0% {
                transform: translateX(0) scale(1);
                opacity: 1;
                z-index: 10;
            }
            100% {
                transform: translateX(100%) scale(0.95);
                opacity: 0;
                z-index: 1;
            }
        }

        /* Slide to previous page (new page enters from left) */
        @keyframes slidePrevEnter {
            0% {
                transform: translateX(-100%) scale(0.95);
                opacity: 0;
                z-index: 5;
            }
            100% {
                transform: translateX(0) scale(1);
                opacity: 1;
                z-index: 10;
            }
        }

        .page-image {
            max-width: 100%;
            max-height: 85vh;
            width: auto;
            height: auto;
            margin: 0 auto;
            display: block;
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(217, 119, 6, 0.15);
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .page-image:hover {
            transform: scale(1.02);
        }

        /* Black and White Filter */
        .page-image.bw-filter {
            filter: grayscale(100%) contrast(1.2);
        }

        /* Navigation Controls */
        .navigation {
            max-width: 1400px;
            margin: 40px auto 0;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            backdrop-filter: blur(2px);
            border: 1px solid #d97706;
        }

        .nav-btn {
            padding: 15px 35px;
            background: linear-gradient(135deg, #f59e0b, #d97706);
            color: #ffffff;
            border: none;
            border-radius: 10px;
            font-size: 1em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 20px rgba(217, 119, 6, 0.2);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .nav-btn:hover:not(:disabled) {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(217, 119, 6, 0.3);
        }

        .nav-btn:disabled {
            background: rgba(209, 213, 219, 0.5);
            cursor: not-allowed;
            box-shadow: none;
            color: rgba(107, 114, 128, 0.5);
        }

        /* Page Thumbnails */
        .thumbnail-strip {
            max-width: 1400px;
            margin: 40px auto;
            display: flex;
            gap: 15px;
            padding: 25px;
            overflow-x: auto;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            scrollbar-width: thin;
            scrollbar-color: #d97706 rgba(255, 255, 255, 0.1);
        }

        .thumbnail-strip::-webkit-scrollbar {
            height: 10px;
        }

        .thumbnail-strip::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }

        .thumbnail-strip::-webkit-scrollbar-thumb {
            background: #d97706;
            border-radius: 10px;
        }

        .thumbnail-item {
            flex-shrink: 0;
            text-align: center;
        }

        .thumbnail {
            width: 120px;
            height: 180px;
            object-fit: cover;
            border-radius: 10px;
            cursor: pointer;
            border: 3px solid transparent;
            transition: all 0.3s ease;
            opacity: 0.7;
        }

        .thumbnail:hover {
            border-color: #f59e0b;
            opacity: 1;
            transform: scale(1.05);
        }

        .thumbnail.active {
            border-color: #d97706;
            opacity: 1;
            box-shadow: 0 5px 25px rgba(217, 119, 6, 0.3);
        }

        .thumbnail-label {
            margin-top: 8px;
            font-size: 0.85em;
            color: #92400e;
            font-weight: 600;
        }

        /* Warning Banner */
        .warning-banner {
            max-width: 900px;
            margin: 40px auto;
            padding: 25px 30px;
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border-left: 5px solid #d97706;
            border-radius: 10px;
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .warning-icon {
            font-size: 2.5em;
            filter: drop-shadow(0 0 10px rgba(217, 119, 6, 0.2));
        }

        .warning-content {
            flex: 1;
        }

        .warning-title {
            font-size: 1.3em;
            font-weight: 700;
            color: #d97706;
            margin-bottom: 10px;
        }

        .warning-text {
            color: #1f2937;
            line-height: 1.6;
        }

        /* Fullscreen Mode */
        body.fullscreen {
            overflow: hidden;
        }

        body.fullscreen .reading-controls,
        body.fullscreen .navigation,
        body.fullscreen .thumbnail-strip {
            display: none;
        }

        body.fullscreen .comic-viewer-wrapper {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 9999;
            padding: 0;
            background: #fffbe6;
        }

        body.fullscreen .comic-display {
            height: 100vh;
            min-height: 100vh;
        }

        body.fullscreen .page-image {
            max-height: 100vh;
            border-radius: 0;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .comic-title {
                font-size: 2em;
            }

            .comic-subtitle {
                font-size: 1.1em;
            }

            .reading-controls {
                flex-direction: column;
                gap: 15px;
            }

            .page-indicator {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }

            .navigation {
                flex-wrap: wrap;
            }

            .nav-btn {
                padding: 12px 25px;
                font-size: 0.9em;
            }

            .start-reading-btn {
                font-size: 1.1em;
                padding: 15px 35px;
            }
        }

        /* Hide intro sections when reading */
        body.reading-mode .header,
        body.reading-mode .story-container,
        body.reading-mode .character-section,
        body.reading-mode .warning-banner,
        body.reading-mode .start-reading-section {
            display: none;
        }

        body.reading-mode .comic-viewer-wrapper {
            display: block;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="comic-logo">
            <h1 class="comic-title">SẬP BẪY ONLINE</h1>
            <p class="comic-subtitle">Một Khoảnh Khắc Cảnh Tỉnh</p>
            <div class="comic-meta">
                <span class="meta-item"><span class="meta-label">Thể loại:</span>Edutainment, Drama</span>
                <span class="meta-item"><span class="meta-label">Đối tượng:</span>Học sinh 11-18 tuổi</span>
                <span class="meta-item"><span class="meta-label">Phong cách:</span>Modern Manga</span>
                <span class="meta-item"><span class="meta-label">Số trang:</span>7 trang (1 cover + 6 trang)</span>
            </div>
        </div>
    </div>

    <!-- Start Reading Button (Top) -->
    <div class="start-reading-section">
        <button class="start-reading-btn" id="startReadingBtn">🔖 Bắt Đầu Đọc</button>
    </div>

    <!-- Warning Banner -->
    <div class="warning-banner">
        <div class="warning-icon">⚠️</div>
        <div class="warning-content">
            <div class="warning-title">Cảnh Báo Quan Trọng</div>
            <div class="warning-text">
                Truyện này nhằm mục đích giáo dục về nguy cơ lừa đảo trực tuyến. 
                Hãy luôn cảnh giác khi mua sắm online và xác minh nguồn gốc website trước khi thanh toán.
            </div>
        </div>
    </div>

    <!-- Story Section -->
    <div class="story-container">
        <div class="story-header">
            <div class="story-icon">📖</div>
            <h2 class="story-title">Câu Chuyện</h2>
        </div>
        <div class="story-content">
            <strong>Trang 1 - "404 - Hy Vọng Không Tìm Thấy":</strong> Mai phát hiện website đã biến mất, 
            nhận ra mình bị lừa đảo. Khoảnh khắc đau đớn của sự thật.<br><br>
            
            <strong>Trang 2 - "Cú Nhấp Chuột Vội Vã":</strong> Flashback - Mai thuyết phục mẹ, háo hức 
            nhập thông tin thanh toán để mua lightstick K-pop giảm giá.<br><br>
            
            <strong>Trang 3 - "Sự Im Lặng Đáng Sợ":</strong> Một tuần trôi qua không có hàng. Mai kiểm tra 
            và thấy thông báo "404 Not Found" - website đã biến mất.<br><br>
            
            <strong>Trang 4 - "Bài Học Đắt Giá":</strong> Mẹ và bạn thân An an ủi Mai. Cả ba cùng tìm hiểu 
            về dấu hiệu lừa đảo online.<br><br>
            
            <strong>Trang 5 - "Chia Sẻ Để Bảo Vệ":</strong> Mai và An tạo bài đăng cảnh báo cho học sinh khác, 
            biến nỗi đau thành bài học ý nghĩa.<br><br>
            
            <strong>Trang 6 - "Lan Tỏa Bài Học":</strong> Các bài học ý nghĩa từ câu chuyện của Mai 
            cần được lan truyền rộng rãi để bảo vệ nhiều bạn trẻ khỏi bẫy lừa đảo online.
        </div>
    </div>

    <!-- Character Section -->
    <div class="character-section">
        <div class="character-card">
            <div class="character-header">
                <h3 class="character-name">Mai</h3>
                <span class="character-role">Nhân Vật Chính</span>
            </div>
            <div class="character-details">
                <div class="detail-group">
                    <div class="detail-label">Tuổi & Giới Tính</div>
                    <div class="detail-value">16 tuổi, Nữ</div>
                </div>
                <div class="detail-group">
                    <div class="detail-label">Tính Cách</div>
                    <div class="detail-value">Năng động, hơi bốc đồng, đam mê văn hóa K-pop</div>
                </div>
                <div class="detail-group">
                    <div class="detail-label">Ngoại Hình</div>
                    <div class="detail-value">Cao 1m60, tóc đen dài ngang vai, da sáng màu vàng</div>
                </div>
                <div class="detail-group">
                    <div class="detail-label">Bối Cảnh</div>
                    <div class="detail-value">Học sinh trung học háo hức mua lightstick K-pop giảm giá online, nhưng đã trở thành nạn nhân của lừa đảo</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Comic Viewer -->
    <div class="comic-viewer-wrapper" id="comicViewer">
        <div class="reading-controls">
            <div class="page-indicator">
                <span class="page-number" id="pageNumber">Cover</span>
                <span class="page-title" id="pageTitle"></span>
            </div>
            <div class="navigation-guideline" style="margin-left:20px;color:#d97706;font-size:1em;font-weight:600;">
                <span>Nhấn <b>←</b> hoặc <b>→</b> để chuyển trang. Bạn cũng có thể dùng phím <b>A/D</b> hoặc <b>Space</b>!</span>
            </div>
            <div class="controls-right">
                <button class="bw-filter-btn" id="bwFilterBtn">⬛ Đen Trắng</button>
                <button class="fullscreen-btn animation-toggle-btn" id="animationToggleBtn">🎬 Hiệu Ứng</button>
                <button class="close-btn" id="closeBtn">✕ Đóng</button>
                <button class="fullscreen-btn" id="fullscreenBtn">⛶ Toàn Màn Hình</button>
            </div>
        </div>

        <div class="comic-display" id="comicDisplay">
            <!-- Pages will be inserted here dynamically -->
        </div>

        <div class="navigation">
            <button class="nav-btn" id="prevBtn" disabled>← Trước</button>
            <button class="nav-btn" id="nextBtn">Sau →</button>
        </div>

        <div class="thumbnail-strip" id="thumbnailStrip">
            <!-- Thumbnails will be inserted here dynamically -->
        </div>
    </div>

    <script>
        // ====================================
        // CẤU HÌNH TRUYỆN TRANH
        // ====================================
        
        // Detect if running locally or on server
        const basePath = window.location.protocol === 'file:' ? '' : '/';
        
        const comicData = {
            title: "Sập Bẫy Online",
            subtitle: "Một Khoảnh Khắc Cảnh Tỉnh",
            
            pages: [
                {
                    pageNumber: 0,
                    pageType: "cover",
                    pageTitle: "Cover",
                    imageUrl: basePath + "images/cover.png",
                    altText: "Cover của truyện Sập Bẫy Online"
                },
                {
                    pageNumber: 1,
                    pageType: "content",
                    pageTitle: "Trang 1",
                    imageUrl: basePath + "images/page1.png",
                    altText: "Trang 1 - 1 panel"
                },
                {
                    pageNumber: 2,
                    pageType: "content",
                    pageTitle: "Trang 2",
                    imageUrl: basePath + "images/page2.png",
                    altText: "Trang 2 - 4 panels"
                },
                {
                    pageNumber: 3,
                    pageType: "content",
                    pageTitle: "Trang 3",
                    imageUrl: basePath + "images/page3.png",
                    altText: "Trang 3 - 4 panels"
                },
                {
                    pageNumber: 4,
                    pageType: "content",
                    pageTitle: "Trang 4",
                    imageUrl: basePath + "images/page4.png",
                    altText: "Trang 4 - 2 panels"
                },
                {
                    pageNumber: 5,
                    pageType: "content",
                    pageTitle: "Trang 5",
                    imageUrl: basePath + "images/page5.png",
                    altText: "Trang 5 - 3 panels"
                },
                {
                    pageNumber: 6,
                    pageType: "content",
                    pageTitle: "Trang 6",
                    imageUrl: basePath + "images/page6.png",
                    altText: "Trang 6 - Lan tỏa bài học"
                }
            ]
        };

        // ====================================
        // MÃ ĐIỀU KHIỂN TRUYỆN TRANH
        // ====================================

        let currentPageIndex = 0;
        let isFullscreen = false;
        let isBWFilter = true; // Black & White filter is ON by default
        let isAnimating = false;
        let isAnimationEnabled = false; // Animation is OFF by default
        let navigationDirection = 'next'; // Track direction for animation

        const startReadingBtn = document.getElementById('startReadingBtn');
        const closeBtn = document.getElementById('closeBtn');
        const comicViewer = document.getElementById('comicViewer');
        const comicDisplay = document.getElementById('comicDisplay');
        const pageNumberEl = document.getElementById('pageNumber');
        const pageTitleEl = document.getElementById('pageTitle');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');
        const fullscreenBtn = document.getElementById('fullscreenBtn');
        const bwFilterBtn = document.getElementById('bwFilterBtn');
        const animationToggleBtn = document.getElementById('animationToggleBtn');
        const thumbnailStrip = document.getElementById('thumbnailStrip');

        // Initialize
        function init() {
            loadComic();
            setupEventListeners();
            // Apply B&W filter by default (exclude cover)
            applyDefaultBWFilter();
        }
        
        // Apply black and white filter by default to all content pages
        function applyDefaultBWFilter() {
            const allPageImages = document.querySelectorAll('.page-image');
            allPageImages.forEach((img, index) => {
                // Skip cover page (index 0)
                if (index > 0) {
                    img.classList.add('bw-filter');
                }
            });
            // Update button state
            bwFilterBtn.classList.add('active');
            bwFilterBtn.textContent = '🎨 Màu';
        }

        // Load comic data
        function loadComic() {
            // Create page containers
            comicDisplay.innerHTML = '';
            comicData.pages.forEach((page, index) => {
                const pageContainer = document.createElement('div');
                pageContainer.classList.add('page-container');
                pageContainer.dataset.pageIndex = index;
                
                const img = document.createElement('img');
                img.src = page.imageUrl;
                img.alt = page.altText;
                img.classList.add('page-image');
                img.loading = 'lazy';
                
                // Click image to go next
                img.addEventListener('click', goToNextPage);
                
                pageContainer.appendChild(img);
                comicDisplay.appendChild(pageContainer);
            });

            // Create thumbnails
            thumbnailStrip.innerHTML = '';
            comicData.pages.forEach((page, index) => {
                const thumbItem = document.createElement('div');
                thumbItem.classList.add('thumbnail-item');
                
                const thumb = document.createElement('img');
                thumb.src = page.imageUrl;
                thumb.classList.add('thumbnail');
                thumb.dataset.pageIndex = index;
                thumb.alt = `${page.pageTitle} thumbnail`;
                
                const label = document.createElement('div');
                label.classList.add('thumbnail-label');
                label.textContent = page.pageType === 'cover' ? 'Cover' : page.pageTitle;
                
                thumb.addEventListener('click', () => {
                    if (!isAnimating) {
                        navigationDirection = index > currentPageIndex ? 'next' : 'prev';
                        currentPageIndex = index;
                        displayCurrentPage();
                    }
                });
                
                thumbItem.appendChild(thumb);
                thumbItem.appendChild(label);
                thumbnailStrip.appendChild(thumbItem);
            });
        }

        // Display current page
        function displayCurrentPage() {
            if (isAnimating) return; // Prevent rapid page changes during animation
            
            const currentPage = comicData.pages[currentPageIndex];
            const allContainers = document.querySelectorAll('.page-container');

            // Get previous page container for exit animation
            const previousContainer = document.querySelector('.page-container.active');
            
            // Remove all animation classes
            allContainers.forEach(page => {
                page.classList.remove('active', 'flip-next-enter', 'flip-next-exit', 'flip-prev-enter', 'flip-prev-exit');
            });

            // Get the new current page container
            const currentContainer = document.querySelector(`[data-page-index="${currentPageIndex}"]`);
            
            if (currentContainer) {
                // Only animate if animation is enabled
                if (isAnimationEnabled) {
                    isAnimating = true;
                    
                    // Apply exit animation to previous page if exists
                    if (previousContainer && previousContainer !== currentContainer) {
                        if (navigationDirection === 'next') {
                            previousContainer.classList.add('active', 'slide-next-exit');
                        } else {
                            previousContainer.classList.add('active', 'slide-prev-exit');
                        }
                    }
                    
                    // Apply enter animation to new page
                    currentContainer.classList.add('active');
                    if (navigationDirection === 'next') {
                        currentContainer.classList.add('slide-next-enter');
                    } else {
                        currentContainer.classList.add('slide-prev-enter');
                    }
                    
                    // Clean up after animation completes
                    setTimeout(() => {
                        allContainers.forEach(page => {
                            page.classList.remove('slide-next-enter', 'slide-next-exit', 'slide-prev-enter', 'slide-prev-exit');
                            if (page !== currentContainer) {
                                page.classList.remove('active');
                            }
                        });
                        isAnimating = false;
                    }, 800); // Match animation duration
                } else {
                    // No animation - instant page change
                    allContainers.forEach(page => {
                        page.classList.remove('active');
                    });
                    currentContainer.classList.add('active');
                }
            }

            // Update page info
            if (currentPage.pageType === 'cover') {
                pageNumberEl.textContent = 'Cover';
                pageTitleEl.textContent = '';
            } else {
                pageNumberEl.textContent = `Trang ${currentPage.pageNumber}`;
                pageTitleEl.textContent = '';
            }

            // Update navigation buttons
            prevBtn.disabled = currentPageIndex === 0;
            nextBtn.disabled = currentPageIndex === comicData.pages.length - 1;

            // Update thumbnails
            updateThumbnails();

            // Scroll to top of page
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Update thumbnails
        function updateThumbnails() {
            const thumbnails = thumbnailStrip.querySelectorAll('.thumbnail');
            thumbnails.forEach((thumb, index) => {
                if (index === currentPageIndex) {
                    thumb.classList.add('active');
                    thumb.parentElement.scrollIntoView({ 
                        behavior: 'smooth', 
                        block: 'nearest', 
                        inline: 'center' 
                    });
                } else {
                    thumb.classList.remove('active');
                }
            });
        }

        // Navigation functions
        function goToPreviousPage() {
            if (currentPageIndex > 0 && !isAnimating) {
                navigationDirection = 'prev';
                currentPageIndex--;
                displayCurrentPage();
            }
        }

        function goToNextPage() {
            if (currentPageIndex < comicData.pages.length - 1 && !isAnimating) {
                navigationDirection = 'next';
                currentPageIndex++;
                displayCurrentPage();
            }
        }

        // Toggle fullscreen
        function toggleFullscreen() {
            isFullscreen = !isFullscreen;
            document.body.classList.toggle('fullscreen', isFullscreen);
            fullscreenBtn.textContent = isFullscreen ? '✕ Thoát' : '⛶ Toàn Màn Hình';
        }

        // Toggle black and white filter
        function toggleBWFilter() {
            isBWFilter = !isBWFilter;
            bwFilterBtn.classList.toggle('active', isBWFilter);
            bwFilterBtn.textContent = isBWFilter ? '🎨 Màu' : '⬛ Đen Trắng';
            
            // Apply filter to all content pages (exclude cover)
            const allPageImages = document.querySelectorAll('.page-image');
            allPageImages.forEach((img, index) => {
                // Skip cover page (index 0)
                if (index > 0) {
                    img.classList.toggle('bw-filter', isBWFilter);
                }
            });
        }

        // Toggle page turn animation
        function toggleAnimation() {
            isAnimationEnabled = !isAnimationEnabled;
            animationToggleBtn.classList.toggle('active', isAnimationEnabled);
            animationToggleBtn.textContent = isAnimationEnabled ? '🎬 Hiệu Ứng Bật' : '🎬 Hiệu Ứng';
        }

        // Start reading
        function startReading() {
            document.body.classList.add('reading-mode');
            currentPageIndex = 0;
            navigationDirection = 'next';
            displayCurrentPage();
        }

        // Close reading
        function closeReading() {
            document.body.classList.remove('reading-mode');
            if (isFullscreen) {
                toggleFullscreen();
            }
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Setup event listeners
        function setupEventListeners() {
            startReadingBtn.addEventListener('click', startReading);
            closeBtn.addEventListener('click', closeReading);
            prevBtn.addEventListener('click', goToPreviousPage);
            nextBtn.addEventListener('click', goToNextPage);
            fullscreenBtn.addEventListener('click', toggleFullscreen);
            bwFilterBtn.addEventListener('click', toggleBWFilter);
            animationToggleBtn.addEventListener('click', toggleAnimation);

            // Keyboard navigation
            document.addEventListener('keydown', (e) => {
                if (!document.body.classList.contains('reading-mode')) return;

                if (e.key === 'ArrowLeft' || e.key === 'a' || e.key === 'A') {
                    goToPreviousPage();
                } else if (e.key === 'ArrowRight' || e.key === 'd' || e.key === 'D' || e.key === ' ') {
                    e.preventDefault();
                    goToNextPage();
                } else if (e.key === 'Escape') {
                    if (isFullscreen) {
                        toggleFullscreen();
                    } else {
                        closeReading();
                    }
                } else if (e.key === 'f' || e.key === 'F') {
                    toggleFullscreen();
                } else if (e.key === 'Home') {
                    currentPageIndex = 0;
                    displayCurrentPage();
                } else if (e.key === 'End') {
                    currentPageIndex = comicData.pages.length - 1;
                    displayCurrentPage();
                }
            });
        }

        // Initialize on load
        init();
    </script>
</body>
</html>